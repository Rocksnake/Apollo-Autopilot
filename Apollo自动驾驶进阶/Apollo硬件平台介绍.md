# 硬件平台介绍

## 研发流程

![在这里插入图片描述](https://img-blog.csdnimg.cn/20200814221543160.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1Jva29CYXNpbGlzaw==,size_16,color_FFFFFF,t_70#pic_center)

* 软件在环：软件在环是基于仿真和模拟的软件仿真，类似于赛车类游戏。即是在软件系统里仿真模拟出真实的道路环境如光照、天气等自然环境，开发者可将自动驾驶代码开发完毕后，在仿真系统内运行，测试是否可以实现目标。

* 硬件在环：硬件在环是基于必要的硬件平台。在第一步的软件仿真结束后，将所有的仿真结果与传感器、计算单元集合在一起，在硬件环境里测试。

* 车辆在环：车辆在环是基于车辆执行。在第二步硬件环境里测试完成后实施的第三步，即在一个封闭环境中测试开发者所开发功能，封闭环境中不会有交通流的干扰。

* 司机在环：司机在环是基于实际道路。在第三步测试成功后进入到司机在环，司机在环主要是研究人——车——路——交通四者之间的相互作用，它不仅测试自动驾驶的程序代码，还能获得专业司机的评判。

> 自动驾驶不仅仅是一个汽车智能系统的问题，更是一个人机交互的问题。所以从整个研究来看，基于人的设计是必不可少的。

## 传感器介绍

|    设备    |                     作用                     |                       特点                       |                     核心                      |
| :--------: | :------------------------------------------: | :----------------------------------------------: | :-------------------------------------------: |
|   摄像头   | 车道线和交通标识牌、红绿灯以及车辆和行人检测 |       检测信息全面、价格便宜、受天气影响大       | 镜头、镜头模组、滤光片、CMOS/CCD、ISP数据传输 |
|  激光雷达  |      经过发射激光波对前面障碍物进行检验      |         同轴旋转、相控阵、棱镜旋转和MEMS         |              波的反射与时间计算               |
| 毫米波雷达 |                   检测车辆                   | 检测速度快，准确，不受天气干扰，但无法识别车道线 |      发射芯片、计算机运算等对距离的计算       |

**感知系统**分为汽车运动、环境感知和驾驶员监测三部分：

* 车辆运动主要分为惯性导航、速度传感器、角度传感器和全球定位系统。
* 环境感知主要分为激光雷达、超声波、摄像头、毫米波雷达、V2X。
* 驾驶员监测主要分为摄像头和生物电传感。

**决策系统**分为计算单元、T-BOX和黑匣子三部分：

* 计算单元里是自动驾驶感知决策控制的算法。目前自动驾驶用的是X86结构的服务器或工控机。

* T-BOX即Telematics BOX，是车联网的通讯网关，它上接互联网下接CAN总线。例如手机上APP发送的开关门指令，都是通过T-BOX网关将操作指令发送到CAN总线来进行操控的。

* 黑匣子是用来记录无人驾驶过程中所有的信息和状态。

**控制系统**部分分为车辆控制和警告系统：

* 车辆控制主要分为制动、转向、发动机和变速箱。
* 警告系统主要分为声音、图像和震动 。

**安装位置：**

* 激光雷达是360°旋转的，所以它都是安装在车顶；

* 毫米波雷达的指向性很强，所以的它一般安装在前后保险杠上；
* 考虑到车身在道路上的俯仰和姿态的干扰，所以组合导航系统一般是安装在两个后车轮的中轴线上；
* 车身的360°都会安装摄像头。

**未来自动驾驶传感器的趋势**：自动驾驶传感器离不开多传感器的融合。激光雷达和摄像头都属于光学类的传感器，它们核心零部件和处理电路很相似，未来有可能将激光雷达和摄像头前端融合到一起，直接输出RGB、 XYZ融合后的颜色加点云信息，然后传输到后端的计算来进行处理。

## 计算单元

> 所有的CPU、GPU、FPGA、MCU和总线都要做冗余设计，以防止单点故障。

目前计算单元都是集中式的架构，即将所有的工作都放到一个工控机当中。

1. 这种架构的缺点是体积大、功耗高，不适应未来的量产；优点是方便代码的快速迭代，工控机卡槽的设计方便硬件更新和扩展 ;
2. 由于集中式的缺点，未来将会考虑嵌入式的方案。将各传感器的原始数据先融合到一个Sensor Box中，在其中完成数据融合， 然后将融合后的数据给到后端计算平台处理；
   * Sensor Box：目前所用传感器给出的原始数据该如何判断融合完成后是否是判断同一个目标，需要有一个时间戳同步，保证这个时间戳下每个传感器探测的都是同一个坐标系，时间戳的同步是在Sensor Box里面完成的。
3. 这种方案将原来集中式计算的功能拆解出来，可以降低整体系统的功耗，但是不足以面向更多的量产化。

## 线控化

> 自动驾驶线控系统（control by wire）指的是汽车的控制是由一些简单命令完成的，而不是由物理操作完成的。

线控部分相当于人的手和脚，在线控系统里执行上端的命令。主要分为三大部分：减速控制、转向控制和加速控制。

线控油门是对自动驾驶车辆加速度的控制，减速刹车踏板上有位置传感器可检测到刹车深浅度，该传感器传送指令到EMS（发动机制动系统）后，气门进气量越多，加速度即越快。

**线控化阶段**：

1. 对原车的方向盘踏板进行改装，将一些转向管柱截断后，加装转向电机，通过控制电机进行转向，缺点是未经过原车系统测试验证，存在安全隐患。

2. 基于原车的辅助驾驶系统，对Can总线协议进行破解，通过原车总线指令控制车的转向和制动。

3. 从车底盘开始开发的一套系统，转向线控完全按照自动驾驶需求定制，与2.0的区别在于考虑到冗余和备份的需求。